generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model RefreshToken {
  id         String    @unique @default(cuid())
  userId     String
  secretHash String    @unique
  createdAt  DateTime  @default(now())
  expiresAt  DateTime
  revokedAt  DateTime?
}

model EmailVerificationToken {
  id        String    @unique @default(cuid())
  userId    String
  tokenHash String    @unique
  createdAt DateTime  @default(now())
  expiresAt DateTime
  usedAt    DateTime?
}

model User {
  id         String    @unique @default(cuid())
  username   String    @unique
  fullname   String
  email      String    @unique
  password   String
  isVerified Boolean   @default(false)
  verifiedAt DateTime?
}

model categories {
  id                 String               @id @default(cuid())
  name               String
  courses_categories courses_categories[]
}

model courses {
  id                 String               @id @default(cuid())
  title              String
  description        String?              @db.Text
  courses_categories courses_categories[]
  price              Int
  thumbnailId        String?
  thumbnail          Asset?               @relation(fields: [thumbnailId], references: [id])
}

model courses_categories {
  course_id   String
  category_id String
  courses     courses    @relation(fields: [course_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "courses_categories_ibfk_1")
  categories  categories @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "courses_categories_ibfk_2")

  @@id([course_id, category_id])
  @@index([category_id], map: "category_id")
}

model Asset {
  id          String       @id @default(cuid())
  publicId    String
  assetOwners AssetOwner[]
  courses     courses[]

  @@index([publicId])
}

model AssetOwner {
  id        String    @id @default(cuid())
  assetId   String
  asset     Asset     @relation(fields: [assetId], references: [id])
  ownerId   String
  ownerType OwnerType
  role      AssetRole

  @@index([ownerType, role, ownerId])
}

enum OwnerType {
  COURSE
}

enum AssetRole {
  THUMBNAIL
}
